<!DOCTYPE html>
<html lang="th" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Scan to Earn üåø</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <span class="brand-icon">üåø</span>
                <span class="brand-text">Scan<span class="highlight">2</span>Earn</span>
                <span class="admin-badge">Admin</span>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#" class="nav-link active" data-section="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-link" data-section="bins">
                    <span class="nav-icon">üóëÔ∏è</span>
                    <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞</span>
                </a>
                <a href="#" class="nav-link" data-section="qrcode">
                    <span class="nav-icon">üì±</span>
                    <span>‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code</span>
                </a>
                <a href="#" class="nav-link" data-section="users">
                    <span class="nav-icon">üë•</span>
                    <span>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                </a>
                <a href="#" class="nav-link" data-section="admins">
                    <span class="nav-icon">üîê</span>
                    <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <a href="index.html" class="nav-link">
                    <span class="nav-icon">üè†</span>
                    <span>‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ User</span>
                </a>
                <a href="#" class="nav-link logout" id="adminLogout">
                    <span class="nav-icon">üö™</span>
                    <span>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span>
                </a>
            </div>
        </aside>
        
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        <button class="mobile-menu-btn" id="mobileMenuBtn">‚ò∞</button>
        
        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <h1 class="page-title" id="pageTitle">üìä Dashboard</h1>
                <div class="header-actions">
                    <div class="date-filter">
                        <select id="dateFilter" class="filter-select">
                            <option value="today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</option>
                            <option value="week">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</option>
                            <option value="month" selected>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</option>
                            <option value="year">‡∏õ‡∏µ‡∏ô‡∏µ‡πâ</option>
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        </select>
                    </div>
                    <button class="theme-toggle" id="adminThemeToggle" title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°">
                        <span id="adminThemeIcon">üåô</span>
                    </button>
                    <div class="admin-user">
                        <span class="admin-name" id="adminName">Admin</span>
                        <div class="admin-avatar">üë®‚Äçüíº</div>
                    </div>
                </div>
            </header>
            
            <!-- Dashboard Section -->
            <section class="admin-section active" id="dashboardSection">
                <div class="stats-overview">
                    <div class="overview-card">
                        <div class="card-icon blue">üë•</div>
                        <div class="card-content">
                            <span class="card-value" id="statUsers">0</span>
                            <span class="card-label">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon green">üóëÔ∏è</div>
                        <div class="card-content">
                            <span class="card-value" id="statBins">0</span>
                            <span class="card-label">‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞ Active</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon gold">üíé</div>
                        <div class="card-content">
                            <span class="card-value" id="statPoints">0</span>
                            <span class="card-label">‡πÅ‡∏ï‡πâ‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏à‡∏Å‡πÑ‡∏õ</span>
                        </div>
                    </div>
                    <div class="overview-card">
                        <div class="card-icon purple">üì∑</div>
                        <div class="card-content">
                            <span class="card-value" id="statScans">0</span>
                            <span class="card-label">‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                        </div>
                    </div>
                </div>
                
                <div class="charts-row">
                    <div class="chart-card">
                        <h3>üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô (7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</h3>
                        <div class="bar-chart" id="scanChart"></div>
                    </div>
                    <div class="chart-card">
                        <h3>ü•ß ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏¢‡∏∞‡∏ó‡∏µ‡πà‡∏ó‡∏¥‡πâ‡∏á</h3>
                        <div class="pie-chart">
                            <div class="pie-item">
                                <span class="pie-icon">üóëÔ∏è</span>
                                <div class="pie-info">
                                    <span class="pie-label">‡∏ñ‡∏±‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</span>
                                    <div class="pie-bar"><div class="pie-fill general" id="generalBar"></div></div>
                                    <span class="pie-percent" id="generalPercent">0%</span>
                                </div>
                            </div>
                            <div class="pie-item">
                                <span class="pie-icon">‚ôªÔ∏è</span>
                                <div class="pie-info">
                                    <span class="pie-label">‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•</span>
                                    <div class="pie-bar"><div class="pie-fill recycle" id="recycleBar"></div></div>
                                    <span class="pie-percent" id="recyclePercent">0%</span>
                                </div>
                            </div>
                            <div class="pie-item">
                                <span class="pie-icon">‚ò¢Ô∏è</span>
                                <div class="pie-info">
                                    <span class="pie-label">‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</span>
                                    <div class="pie-bar"><div class="pie-fill hazard" id="hazardBar"></div></div>
                                    <span class="pie-percent" id="hazardPercent">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="activity-card">
                    <h3>üïê ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
                    <div class="activity-list" id="activityList">
                        <div class="empty-activity"><span>üì≠</span><p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p></div>
                    </div>
                </div>
            </section>
            
            <!-- Bins Section -->
            <section class="admin-section" id="binsSection">
                <div class="section-actions">
                    <button class="btn-add" id="btnAddBin"><span>‚ûï</span> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞</button>
                </div>
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>‡∏£‡∏´‡∏±‡∏™‡∏ñ‡∏±‡∏á</th>
                                <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="binsTableBody"></tbody>
                    </table>
                </div>
            </section>
            
            <!-- QR Code Section -->
            <section class="admin-section" id="qrcodeSection">
                <div class="qr-generator">
                    <div class="qr-form-card">
                        <h3>ÔøΩ ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code</h3>
                        
                        <div class="form-group">
                            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞ <span class="required">*</span></label>
                            <select id="qrBinSelect" class="form-input">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞ --</option>
                            </select>
                        </div>
                        
                        <div class="qr-bin-info" id="qrBinInfo" style="display:none;">
                            <div class="info-row"><span>‡∏£‡∏´‡∏±‡∏™:</span> <strong id="qrSelectedCode">-</strong></div>
                            <div class="info-row"><span>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</span> <strong id="qrSelectedType">-</strong></div>
                            <div class="info-row"><span>‡πÅ‡∏ï‡πâ‡∏°:</span> <strong id="qrSelectedPoints">-</strong></div>
                            <div class="info-row"><span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</span> <strong id="qrSelectedLocation">-</strong></div>
                        </div>
                        
                        <button class="btn-primary" id="btnGenerateQR" disabled>üì± ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code</button>
                        
                        <div class="or-divider"><span>‡∏´‡∏£‡∏∑‡∏≠</span></div>
                        
                        <button class="btn-secondary" id="btnAddNewBinForQR">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ñ‡∏±‡∏á‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á QR</button>
                    </div>
                    
                    <div class="qr-preview-card">
                        <h3>üëÅÔ∏è QR Code ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ</h3>
                        <div class="qr-display" id="qrDisplay">
                            <p class="qr-placeholder">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î "‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code"</p>
                        </div>
                        <button class="btn-download" id="btnDownloadQR" style="display:none;">‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PNG</button>
                    </div>
                </div>
                
                <div class="saved-section">
                    <h3>üìã QR Code ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ</h3>
                    <div class="saved-qr-grid" id="savedQRGrid"></div>
                </div>
            </section>
            
            <!-- Users Section -->
            <section class="admin-section" id="usersSection">
                <div class="section-header-bar">
                    <h3>üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                    <div class="search-box">
                        <input type="text" id="userSearch" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ..." class="form-input">
                    </div>
                </div>
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Email</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th>‡πÅ‡∏ï‡πâ‡∏°</th>
                                <th>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody"></tbody>
                    </table>
                </div>
            </section>
            
            <!-- Admins Section -->
            <section class="admin-section" id="adminsSection">
                <div class="section-actions">
                    <button class="btn-add" id="btnAddAdmin"><span>‚ûï</span> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
                </div>
                <div class="admin-info-note" id="adminNote"></div>
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Email</th>
                                <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                                <th>Role</th>
                                <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="adminsTableBody"></tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>
    
    <!-- MODALS -->
    <!-- Add Bin Modal -->
    <div class="modal" id="addBinModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞</h2>
                <button class="btn-close" onclick="closeModal('addBinModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>‡∏£‡∏´‡∏±‡∏™‡∏ñ‡∏±‡∏á <span class="required">*</span></label>
                    <input type="text" id="newBinCode" class="form-input" placeholder="GEN-003">
                </div>
                <div class="form-group">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                    <select id="newBinType" class="form-input">
                        <option value="general">üóëÔ∏è ‡∏ñ‡∏±‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (10 ‡πÅ‡∏ï‡πâ‡∏°)</option>
                        <option value="recycle">‚ôªÔ∏è ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• (20 ‡πÅ‡∏ï‡πâ‡∏°)</option>
                        <option value="hazardous">‚ò¢Ô∏è ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ (30 ‡πÅ‡∏ï‡πâ‡∏°)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</label>
                    <input type="text" id="newBinLocation" class="form-input" placeholder="‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ B ‡∏ä‡∏±‡πâ‡∏ô 2">
                </div>
                <button class="btn-primary" id="btnSaveBin">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    
    <!-- View/Edit User Modal -->
    <div class="modal" id="userDetailModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h2>
                <button class="btn-close" onclick="closeModal('userDetailModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="user-detail-grid">
                    <div class="detail-item"><label>ID</label><span id="detailUserId">-</span></div>
                    <div class="detail-item"><label>Username</label><input type="text" id="detailUsername" class="form-input" readonly></div>
                    <div class="detail-item"><label>Email</label><input type="email" id="detailEmail" class="form-input"></div>
                    <div class="detail-item"><label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="detailFullName" class="form-input"></div>
                    <div class="detail-item"><label>Role</label><span id="detailRole" class="role-badge">-</span></div>
                    <div class="detail-item"><label>‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏∞‡∏™‡∏°</label><input type="number" id="detailPoints" class="form-input"></div>
                    <div class="detail-item"><label>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠</label><span id="detailCreatedAt">-</span></div>
                    <div class="detail-item"><label>Password (Hash)</label><span id="detailPasswordHash" class="password-hash">-</span></div>
                </div>
                <div class="modal-actions">
                    <button class="btn-secondary" onclick="openResetPasswordFromDetail()">üîë ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
                    <button class="btn-primary" id="btnSaveUserDetail">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
                <input type="hidden" id="editingUserId">
            </div>
        </div>
    </div>
    
    <!-- Reset Password Modal -->
    <div class="modal" id="resetPasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîë ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
                <button class="btn-close" onclick="closeModal('resetPasswordModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p class="reset-info">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ: <strong id="resetUserName">-</strong></p>
                <div class="form-group">
                    <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà <span class="required">*</span></label>
                    <input type="password" id="newPassword" class="form-input" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">
                </div>
                <div class="form-group">
                    <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                    <input type="password" id="confirmNewPassword" class="form-input" placeholder="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                </div>
                <input type="hidden" id="resetUserId">
                <button class="btn-primary" id="btnConfirmResetPassword">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
            </div>
        </div>
    </div>
    
    <!-- Add Admin Modal -->
    <div class="modal" id="addAdminModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
                <button class="btn-close" onclick="closeModal('addAdminModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Username <span class="required">*</span></label>
                    <input type="text" id="newAdminUsername" class="form-input" placeholder="username">
                </div>
                <div class="form-group">
                    <label>Email <span class="required">*</span></label>
                    <input type="email" id="newAdminEmail" class="form-input" placeholder="admin@example.com">
                </div>
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="required">*</span></label>
                    <input type="text" id="newAdminName" class="form-input" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                </div>
                <div class="form-group">
                    <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô <span class="required">*</span></label>
                    <input type="password" id="newAdminPassword" class="form-input" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                </div>
                <button class="btn-primary" id="btnSaveAdmin">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
            </div>
        </div>
    </div>
    
    <script src="config.js"></script>
    <script src="supabase.js"></script>
    <script src="admin.js"></script>
</body>
</html>
